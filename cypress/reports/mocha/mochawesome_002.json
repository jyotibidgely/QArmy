{
  "stats": {
    "suites": 1,
    "tests": 11,
    "passes": 11,
    "pending": 0,
    "failures": 0,
    "start": "2022-08-12T11:28:06.942Z",
    "end": "2022-08-12T11:29:15.788Z",
    "duration": 68846,
    "testsRegistered": 11,
    "passPercent": 100,
    "pendingPercent": 0,
    "other": 0,
    "hasOther": false,
    "skipped": 0,
    "hasSkipped": false
  },
  "results": [
    {
      "uuid": "f7a6f598-9a1d-4c1f-b620-2d6cecc9fc7d",
      "title": "",
      "fullFile": "cypress/e2e/Ameren/GbDownload/GbDownloadAMRG.cy.js",
      "file": "cypress/e2e/Ameren/GbDownload/GbDownloadAMRG.cy.js",
      "beforeHooks": [],
      "afterHooks": [],
      "tests": [],
      "suites": [
        {
          "uuid": "84e898e4-18d5-413e-b1b4-30dd05db5afe",
          "title": "GB download - AMR Gas",
          "fullFile": "",
          "file": "",
          "beforeHooks": [],
          "afterHooks": [],
          "tests": [
            {
              "title": "Invoice data API response",
              "fullTitle": "GB download - AMR Gas Invoice data API response",
              "timedOut": null,
              "duration": 6068,
              "state": "passed",
              "speed": "medium",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "cy.visit(pilotData.url + \"dashboard?user-hash=\" + userHash);\ncy.log(bearerToken);\nobjApiResponse.invoiceDataResponse(uuid, strMeasurementType, bearerToken).then(res => {\n  cy.log(res);\n  objLength = Object.keys(res).length;\n  cy.log(objLength);\n  var firstKey = Object.keys(res)[objLength - 1];\n  let objData = res[firstKey];\n  cy.log(objData);\n  var objFirst = Object.keys(res)[0];\n  var firstObjData = res[objFirst];\n  var firstBillingStartTs = firstObjData['billingStartTs'];\n  var firstStartTs = new Date(firstBillingStartTs * 1000);\n  strMinDate = objGenericPage.changDateFormat(firstStartTs.toDateString());\n  billingEndTs = objData['billingEndTs'];\n  billingStartTs = objData['billingStartTs'];\n  cy.log(billingStartTs);\n  cy.log(billingEndTs);\n  var startTs = new Date(billingStartTs * 1000);\n  var endTs = new Date(billingEndTs * 1000);\n  endTs.setDate(endTs.getDate() - 1);\n  cy.log(startTs.toLocaleString());\n  cy.log(endTs.toDateString());\n  strStartDate = objGenericPage.changDateFormat(startTs.toDateString());\n  strEndDate = objGenericPage.changDateFormat(endTs.toDateString());\n  cy.log('Start date - ' + strStartDate);\n  cy.wrap(strStartDate).as('strStartDate');\n  var newStartTs = new Date(billingEndTs * 1000);\n  newStartTs.setDate(newStartTs.getDate() - 10);\n  strNewStartDate = objGenericPage.changDateFormat(newStartTs.toDateString());\n  newEpochStartTs = newStartTs.getTime() / 1000;\n  var newEndTs = new Date(billingEndTs * 1000);\n  newEndTs.setDate(newEndTs.getDate() - 1);\n  strNewEndDate = objGenericPage.changDateFormat(newEndTs.toDateString());\n  newEpochEndTs = newEndTs.getTime() / 1000;\n});",
              "err": {},
              "uuid": "76130602-44cf-4039-89c7-85c6977b2941",
              "parentUUID": "84e898e4-18d5-413e-b1b4-30dd05db5afe",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "Navigate to Download my data",
              "fullTitle": "GB download - AMR Gas Navigate to Download my data",
              "timedOut": null,
              "duration": 5794,
              "state": "passed",
              "speed": "medium",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "objGenericPage.checkHeader();\ncy.wait(1000);\nobjGenericPage.clickDownloadMyData();\ncy.wait(1000);",
              "err": {},
              "uuid": "719e87dd-d70a-401d-89b4-f437b1077772",
              "parentUUID": "84e898e4-18d5-413e-b1b4-30dd05db5afe",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "Export data - Bill period",
              "fullTitle": "GB download - AMR Gas Export data - Bill period",
              "timedOut": null,
              "duration": 3355,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "var billPeriodStartDate = objGenericPage.changDateFormatString(strStartDate);\nvar billPeriodEndDate = objGenericPage.changDateFormatString(strEndDate);\nvar strBillPeriodDate = billPeriodStartDate + ' - ' + billPeriodEndDate;\ncy.log(strBillPeriodDate);\nobjGbDownload.verifyPageTitle();\nobjGbDownload.verifySubtitle();\nobjGbDownload.verifyExportBillLabel();\nobjGbDownload.verifyExportDaysLabel();\nobjGbDownload.verifyDataMsg();\nobjGbDownload.selectDropdownElement(strBillPeriodDate, objLength);\ncy.get(objGbDownload.exportBtn).should('have.css', 'background-color').and('eq', 'rgb(27, 108, 181)');\ncy.get(objGbDownload.exportBtn).should('have.css', 'cursor').and('eq', 'pointer');\ncy.get('.download-page-btn').contains('Cancel').should('have.css', 'background-color').and('eq', 'rgba(0, 0, 0, 0)');\ncy.get('.download-page-btn').contains('Cancel').should('have.css', 'cursor').and('eq', 'pointer');\nobjGbDownload.clickExport();\nobjGbDownload.checkSuccessMsg('GreenButton data downloaded successfully.');",
              "err": {},
              "uuid": "4c66fa37-0140-4876-a79e-a668fae2649d",
              "parentUUID": "84e898e4-18d5-413e-b1b4-30dd05db5afe",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "Export data - Calendar Days",
              "fullTitle": "GB download - AMR Gas Export data - Calendar Days",
              "timedOut": null,
              "duration": 13497,
              "state": "passed",
              "speed": "slow",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "cy.contains('Export usage for range of days').click();\ncy.wait(200);\ncy.get(objGbDownload.calendarIcon).eq(0).should('be.visible');\ncy.get(objGbDownload.calendarIcon).eq(1).should('be.visible');\ncy.get(objGbDownload.calendarIcon).eq(0).click();\ncy.get('[aria-label=\"Go to the previous month\"]').click();\ncy.get('[role=\"presentation\"]').eq(10).click();\ncy.get(objGbDownload.calendarIcon).eq(1).click();\ncy.get('[aria-label=\"Go to the previous month\"]').click();\ncy.get('[role=\"presentation\"]').eq(11).click();\nobjGbDownload.clickExport();\nobjGbDownload.checkSuccessMsg('GreenButton data downloaded successfully.');\ncy.wait(500); //Min and max dates\nobjGbDownload.enterFromDate(strMinDate);\nobjGbDownload.enterToDate(strEndDate);\nobjGbDownload.clickExport();\nobjGbDownload.checkSuccessMsg('Please select a date range that does not exceed one year.'); //Same date\nobjGbDownload.enterFromDate(strStartDate);\nobjGbDownload.enterToDate(strStartDate);\nobjGbDownload.clickExport();\nobjGbDownload.checkSuccessMsg('GreenButton data downloaded successfully.');",
              "err": {},
              "uuid": "bf69e44a-6f53-4354-ae68-2631ccc7f473",
              "parentUUID": "84e898e4-18d5-413e-b1b4-30dd05db5afe",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "Export data - Days",
              "fullTitle": "GB download - AMR Gas Export data - Days",
              "timedOut": null,
              "duration": 12585,
              "state": "passed",
              "speed": "slow",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "cy.deleteDownloadsFolder();\ncy.contains('Export usage for range of days').click();\nobjGbDownload.enterFromDate('16/09/20');\nobjGbDownload.checkErrorMsg('Invalid Date Format');\nobjGbDownload.enterFromDate('03/02/2000');\nobjGbDownload.checkErrorMsg('Date should not be before minimal date');\nobjGbDownload.enterFromDate(strStartDate);\nobjGbDownload.enterToDate('56/09/2022');\nobjGbDownload.checkErrorMsg('Invalid Date Format');\nobjGbDownload.enterToDate('08/05/2050');\nobjGbDownload.checkErrorMsg('Date should not be after maximal date');\nobjGbDownload.enterToDate(strEndDate);\nobjGbDownload.clickExport();\nobjGbDownload.checkSuccessMsg('GreenButton data downloaded successfully.');",
              "err": {},
              "uuid": "ad4f33a7-3b74-4b56-a45b-ba2f5bcf3ce3",
              "parentUUID": "84e898e4-18d5-413e-b1b4-30dd05db5afe",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "Check Disabled fields",
              "fullTitle": "GB download - AMR Gas Check Disabled fields",
              "timedOut": null,
              "duration": 2475,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "cy.contains('Export usage for range of bill period').click();\ncy.wait(500);\ncy.get(objGbDownload.fromDate).should('be.disabled');\ncy.get(objGbDownload.toDate).should('be.disabled');\ncy.get(objGbDownload.calendarIcon).parent().parent().should('be.disabled');\ncy.contains('Export usage for range of days').click();\ncy.wait(500);\ncy.get(objGbDownload.dropdownEle).should('have.attr', 'aria-disabled', 'true');",
              "err": {},
              "uuid": "b5896fd9-fcdb-46b8-87ad-70011dde8fe9",
              "parentUUID": "84e898e4-18d5-413e-b1b4-30dd05db5afe",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "Cancel button",
              "fullTitle": "GB download - AMR Gas Cancel button",
              "timedOut": null,
              "duration": 1738,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "objGbDownload.clickCancelBtn();\ncy.wait(500);\ncy.get('.home-page-main', {\n  timeout: 10000\n}).should('be.visible');",
              "err": {},
              "uuid": "ff2dd6fd-87b0-420b-a71f-64c19ca94925",
              "parentUUID": "84e898e4-18d5-413e-b1b4-30dd05db5afe",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "Fetch values from RAW data",
              "fullTitle": "GB download - AMR Gas Fetch values from RAW data",
              "timedOut": null,
              "duration": 716,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "objApiResponse.gbJsonResponse(uuid, gatewayId, billingStartTs, newEpochEndTs, bearerToken).then(res => {\n  cy.log(res);\n  var firstKey = Object.keys(res)[0];\n  let objData = res[firstKey];\n  cy.log(objData); // let billingEndTs = objData['billingEndTs']\n  for (let index = 0; index < res.length - 1; index++) {\n    const element = res[index];\n    console.log(element);\n    const time = element['time'];\n    var value = element['value'];\n    const duration = element['duration'];\n    value = value * 3600 / (3600 * 1000 * 1.037 * 29.3);\n    value = Math.round(value * 10) / 10; //round to one decimal place\n    value = value * 100000;\n    value = Math.trunc(value);\n    cy.log(value);\n    strObj = '<espi:IntervalReading><espi:ReadingQuality><espi:quality>17</espi:quality></espi:ReadingQuality><espi:timePeriod><espi:duration>' + duration + '</espi:duration><espi:start>' + time + '</espi:start></espi:timePeriod><espi:value>' + value + '</espi:value></espi:IntervalReading>';\n    arrValues.push(strObj);\n    console.log(strObj);\n  }\n});",
              "err": {},
              "uuid": "ff37e2ca-f224-4d59-81b0-79bdee3f90e6",
              "parentUUID": "84e898e4-18d5-413e-b1b4-30dd05db5afe",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "Fetch values from Meter API",
              "fullTitle": "GB download - AMR Gas Fetch values from Meter API",
              "timedOut": null,
              "duration": 456,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "objApiResponse.meterApiResponse(uuid, gatewayId, bearerToken).then(res => {\n  cy.log(res);\n  var strMeterObj = '/users/' + uuid + '/homes/1/gws/' + gatewayId + '/meters/1';\n  var meterObj = res[strMeterObj];\n  meterToken = meterObj.token;\n  cy.log(meterToken);\n});",
              "err": {},
              "uuid": "930bd7cd-43bf-4865-b584-01f4fce1b1ab",
              "parentUUID": "84e898e4-18d5-413e-b1b4-30dd05db5afe",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "Read download file",
              "fullTitle": "GB download - AMR Gas Read download file",
              "timedOut": null,
              "duration": 643,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "cy.task('downloads', 'cypress/downloads').then(after => {\n  console.log(after);\n  console.log(strObj);\n  cy.readFile(\"cypress/downloads/\" + after).then(fileToRead => {\n    cy.wrap(fileToRead).should('contain', 'Green Button Data File. Meter: ' + meterToken);\n    cy.wrap(fileToRead).should('contain', '<espi:ReadingType><espi:accumulationBehaviour>4</espi:accumulationBehaviour><espi:commodity>7</espi:commodity><espi:dataQualifier>12</espi:dataQualifier><espi:defaultQuality>17</espi:defaultQuality><espi:flowDirection>1</espi:flowDirection><espi:intervalLength>86400</espi:intervalLength><espi:kind>58</espi:kind><espi:phase>769</espi:phase><espi:powerOfTenMultiplier>-3</espi:powerOfTenMultiplier><espi:timeAttribute>0</espi:timeAttribute><espi:uom>119</espi:uom></espi:ReadingType>');\n    for (let index = 0; index < arrValues.length; index++) {\n      const element = arrValues[index];\n      console.log(element);\n      cy.wrap(fileToRead).should('contain', element);\n    }\n  }); //     // cy.readFile(\"cypress/downloads/\"+after).should('contain', '<espi:IntervalBlock><espi:interval><espi:duration>86400</espi:duration><espi:start>1654750800</espi:start></espi:interval><espi:IntervalReading><espi:ReadingQuality><espi:quality>17</espi:quality></espi:ReadingQuality><espi:timePeriod><espi:duration>86400</espi:duration><espi:start>1654750800</espi:start></espi:timePeriod><espi:value>111300</espi:value></espi:IntervalReading></espi:IntervalBlock></content><published>2022-07-26T13:24:52.275Z</published><updated>2022-07-26T13:24:52.275Z</updated></entry><entry><id>urn:uuid:012bc7b5-2bde-3a8e-9874-31f27f3bf0e0</id><link href=\"http://amerenuatapi.bidgely.com/Customer/39977728884556036/UsagePoint/9056348086580949057/MeterReading/5429490602267981274/IntervalBlock/5534999940292988461\" rel=\"self\" type=\"espi-entry/IntervalBlock\"/><link href=\"http://amerenuatapi.bidgely.com/Customer/39977728884556036/UsagePoint/9056348086580949057/MeterReading/5429490602267981274/IntervalBlock\" rel=\"up\" type=\"espi-feed/IntervalBlock\"/><title>IntervalBlock ID: 3582119876618863370; Start: 2022-06-10T05:00-05:00[CST6CDT]</title><content><espi:IntervalBlock><espi:interval><espi:duration>86400</espi:duration><espi:start>1654837200</espi:start></espi:interval><espi:IntervalReading><espi:ReadingQuality><espi:quality>17</espi:quality></espi:ReadingQuality><espi:timePeriod><espi:duration>86400</espi:duration><espi:start>1654837200</espi:start></espi:timePeriod><espi:value>111300</espi:value></espi:IntervalReading></espi:IntervalBlock>')\n  //     //   expect(after.length).to.be.eq(before.length +1)  \n});",
              "err": {},
              "uuid": "d0c40cc6-224b-4415-afeb-eb8490a986fd",
              "parentUUID": "84e898e4-18d5-413e-b1b4-30dd05db5afe",
              "isHook": false,
              "skipped": false
            },
            {
              "title": "Upload data - DMD Validator",
              "fullTitle": "GB download - AMR Gas Upload data - DMD Validator",
              "timedOut": null,
              "duration": 4974,
              "state": "passed",
              "speed": "fast",
              "pass": true,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "cy.visit(\"https://dmdvalidator.greenbuttonalliance.org/\");\ncy.get('#FBSelection', {\n  timeout: 10000\n}).should('be.visible');\ncy.get('select').select('Energy Usage file: Natural Gas Interval Metering');\ncy.wait(200);\ncy.get('#FB_15').uncheck({\n  force: true\n});\ncy.wait(500);\ncy.task('downloads', 'cypress/downloads').then(p => {\n  //file to be uploaded path in project folder\n  const fileToUpload = \"../downloads/\" + p;\n  cy.log(fileToUpload); //upload file with attachFile\n  cy.get('#dropZone').attachFile(fileToUpload, {\n    subjectType: 'drag-n-drop'\n  }); // cy.get(':nth-child(6) > thead > tr > td', { timeout: 15000 }).should('have.text', ' ...all tests were successful.')\n  cy.get('thead > tr > td', {\n    timeout: 15000\n  }).should('have.text', ' ...all tests were successful. ...all tests were successful. ...all tests were successful.');\n  cy.get('.text-danger').should('not.exist');\n});",
              "err": {},
              "uuid": "1ced52ef-997f-4e71-888a-8ed3c2465bbe",
              "parentUUID": "84e898e4-18d5-413e-b1b4-30dd05db5afe",
              "isHook": false,
              "skipped": false
            }
          ],
          "suites": [],
          "passes": [
            "76130602-44cf-4039-89c7-85c6977b2941",
            "719e87dd-d70a-401d-89b4-f437b1077772",
            "4c66fa37-0140-4876-a79e-a668fae2649d",
            "bf69e44a-6f53-4354-ae68-2631ccc7f473",
            "ad4f33a7-3b74-4b56-a45b-ba2f5bcf3ce3",
            "b5896fd9-fcdb-46b8-87ad-70011dde8fe9",
            "ff2dd6fd-87b0-420b-a71f-64c19ca94925",
            "ff37e2ca-f224-4d59-81b0-79bdee3f90e6",
            "930bd7cd-43bf-4865-b584-01f4fce1b1ab",
            "d0c40cc6-224b-4415-afeb-eb8490a986fd",
            "1ced52ef-997f-4e71-888a-8ed3c2465bbe"
          ],
          "failures": [],
          "pending": [],
          "skipped": [],
          "duration": 52301,
          "root": false,
          "rootEmpty": false,
          "_timeout": 2000
        }
      ],
      "passes": [],
      "failures": [],
      "pending": [],
      "skipped": [],
      "duration": 0,
      "root": true,
      "rootEmpty": true,
      "_timeout": 2000
    }
  ],
  "meta": {
    "mocha": {
      "version": "7.0.1"
    },
    "mochawesome": {
      "options": {
        "quiet": false,
        "reportFilename": "mochawesome",
        "saveHtml": false,
        "saveJson": true,
        "consoleReporter": "spec",
        "useInlineDiffs": false,
        "code": true
      },
      "version": "7.1.3"
    },
    "marge": {
      "options": {
        "id": "default",
        "reportDir": "cypress/reports/mocha",
        "quite": true,
        "overwrite": false,
        "html": false,
        "json": true
      },
      "version": "6.2.0"
    }
  }
}